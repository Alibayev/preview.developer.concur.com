---
title: Spend User Provisioning Patch
layout: reference
---

# Spend User Provisioning - PATCH

{% include prerelease.html %}

Spend User Provisioning allows callers to **MODIFY** a user and associated data in the SAP Concur spend domain.

## Modify Spend User Resource <a name="modify-spend-user-resource"></a>

By creating one or more provision requests using the `/Bulk` endpoint to modify existing spend user resources, or using the `/Users` endpoint for modifying a single spend user resource.

**PATCH** is used as the provision operation or http method for modifying a new/existing resource.

**NOTE:** The Spend User extension is the required foundation on which the other spend extensions depend. Without a successful Spend User save, or the existence of a Spend User, the other spend extensions cannot be leveraged for any further operation.

### Scopes <a name="scopes"></a>

- `spend.user.general.writeonly` - Refer to [Scope Usage](./v4.spend-user-get-started.md#scope-usage) for full details.

### Bulk Request <a name="bulk-request"></a>

#### Endpoint

```shell
POST https://www.us.api.concursolutions.com/provisioning/v4/Bulk?companyId={CompanyId}
```

#### Parameters

|Name|Type|Format|Description|
|----|:---:|:----:|-------------|
|CompanyId|`string`|[RFC 4122 A Universally Unique IDentifier (UUID) URN Namespace](https://tools.ietf.org/html/rfc4122)|The unique identifier of a Company. Required with X509 authentication.|

#### Headers

|Name|Type|Format|Description| 
|----|:---:|:----:|-----------|
|concur-correlationid|`string`|[RFC 4122 A Universally Unique IDentifier (UUID) URN Namespace](https://tools.ietf.org/html/rfc4122) | A SAP Concur specific custom header used for technical support|
|Content-Type|`string`| [RFC 7231 Content-Type](https://tools.ietf.org/html/rfc7231#section-3.1.1.5) | Specify the nature of the data in the body of an entity, by giving type and subtype identifiers, and by providing auxiliary information that may be required for certain types (https://www.w3.org/Protocols/rfc1341/4_Content-Type.html) </br> Ex: `application/json`, `application/scim+json`|

#### Payload

* [Bulk Request](#bulk-examples-a-namebulk-examplesa)

### Response <a name="response"></a>

#### Status Codes

* [200 OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)
* [400 Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)
* [401 Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)
* [402 Payment Required](https://tools.ietf.org/html/rfc7231#section-6.5.2)
* [403 Forbidden](https://tools.ietf.org/html/rfc7231#section-6.5.3)
* [404 Not Found](https://tools.ietf.org/html/rfc7231#section-6.5.4)
* [500 Internal Server Error](https://tools.ietf.org/html/rfc7231#section-6.6.1)
* [502 Bad Gateway](https://tools.ietf.org/html/rfc7231#section-6.6.3)
* [503 Service Unavailable](https://tools.ietf.org/html/rfc7231#section-6.6.4)

### Bulk Examples <a name="bulk-examples"></a>

**NOTE:** The UUID must be provided in the path of the request.

#### Request

```json
{
    "schemas": [
        "urn:ietf:params:scim:api:messages:2.0:BulkRequest",
        "urn:ietf:params:scim:api:messages:2.0:PatchOp"
    ],
    "failOnErrors": 1,
    "Operations": [
        {
            "method": "PATCH",
            "path": "/Users/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
            "data": {
                "Operations": [
                    {
                        "op": "replace",
                        "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:User:country",
                        "value": "US"
                    },
                    {
                        "op": "add",
                        "value": {
                            "urn:ietf:params:scim:schemas:extension:spend:2.0:User": {
                                "locale": "es-419",
                                "reimbursementType": "CONCUR_PAY",
                                "customData": [
                                    {
                                        "id": "custom1",
                                        "value": "patchChangeCustom1"
                                    },
                                    {
                                        "id": "custom8",
                                        "value": "newCustomObject"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "op": "add",
                        "value": {
                            "urn:ietf:params:scim:schemas:extension:spend:2.0:Approver": {
                                "budget": [
                                    {
                                        "approver": {
                                            "value": "aaaaaaaa-bbbb-cccc-aaaa-bbbbbbbbbbb3",
                                            "employeeNumber": "100001"
                                        },
                                        "primary": true
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        }
    ]
}
```

### Patch Request <a name="patch-request"></a>

#### Endpoint

```shell
PATCH https://www.us.api.concursolutions.com/provisioning/v4/Users/{UserId}
```

#### Parameters

|Name|Type|Format|Description|
|----|:---:|:----:|-------------|
|UserId|`string`|[RFC 4122 A Universally Unique IDentifier (UUID) URN Namespace](https://tools.ietf.org/html/rfc4122)|The unique identifier of an User|
|CompanyId|`string`|[RFC 4122 A Universally Unique IDentifier (UUID) URN Namespace](https://tools.ietf.org/html/rfc4122)|The unique identifier of a Company. Required with X509 authentication.|

#### Headers

|Name|Type|Format|Description| 
|----|:---:|:----:|-----------|
|concur-correlationid|`string`|[RFC 4122 A Universally Unique IDentifier (UUID) URN Namespace](https://tools.ietf.org/html/rfc4122) | A SAP Concur specific custom header used for technical support|
|Content-Type|`string`| [RFC 7231 Content-Type](https://tools.ietf.org/html/rfc7231#section-3.1.1.5) | Specify the nature of the data in the body of an entity, by giving type and subtype identifiers, and by providing auxiliary information that may be required for certain types (https://www.w3.org/Protocols/rfc1341/4_Content-Type.html) </br> Ex: `application/json`, `application/scim+json`|

#### Payload

* [Patch Request](#patch-request)

### Patch Response <a name="patch-response"></a>

#### Status Codes

* [200 OK](https://tools.ietf.org/html/rfc7231#section-6.3.1)
* [400 Bad Request](https://tools.ietf.org/html/rfc7231#section-6.5.1)
* [401 Unauthorized](https://tools.ietf.org/html/rfc7235#section-3.1)
* [402 Payment Required](https://tools.ietf.org/html/rfc7231#section-6.5.2)
* [403 Forbidden](https://tools.ietf.org/html/rfc7231#section-6.5.3)
* [404 Not Found](https://tools.ietf.org/html/rfc7231#section-6.5.4)
* [500 Internal Server Error](https://tools.ietf.org/html/rfc7231#section-6.6.1)
* [502 Bad Gateway](https://tools.ietf.org/html/rfc7231#section-6.6.3)
* [503 Service Unavailable](https://tools.ietf.org/html/rfc7231#section-6.6.4)

### Patch Examples <a name="patch-examples"></a>

**Section1:** The following lists a few PATCH examples with the **Approver** extension.
#### 1. Request: Add Approver
```json
{
    "schemas": [
        "urn:ietf:params:scim:api:messages:2.0:PatchOp"
    ],
    "Operations": [
        {
            "op": "add",
            "value": {
                "urn:ietf:params:scim:schemas:extension:spend:2.0:Approver": {
                    "report": [
                        {
                            "approver": {
                                "value": "dbc5c27f-afc8-4091-bd2b-d5beca9c8481"
                            },
                            "primary": true
                        }
                    ]
                }
            }
        }
    ]
}
```

#### 2. Request: Replace Approver
```json
{
    "schemas": [
        "urn:ietf:params:scim:api:messages:2.0:PatchOp"
    ],
    "Operations": [
        {
            "op": "replace",
            "value": {
                "urn:ietf:params:scim:schemas:extension:spend:2.0:Approver": {
                    "report": [
                        {
                            "approver": {
                                "value": "5d9b715d-7265-4532-a40d-38271837f538"
                            },
                            "primary": true
                        }
                    ]
                }
            }
        }
    ]
}
```

#### 3. Request: Remove a single Approver
```json
{
    "schemas": [
        "urn:ietf:params:scim:api:messages:2.0:PatchOp"
    ],
    "Operations": [
        {
            "op": "remove",
            "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:Approver:report[approver.value eq \"5d9b715d-7265-4532-a40d-38271837f538\"]"
        }
    ]
}
```
**NOTE:** Remove operation uses the attribute **path** for removing a specific identity.

#### 4. Request: Remove All Approvers
```json
{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [
    {
      "op": "remove",
      "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:Approver:"
    }
  ]
}
```
**NOTE:** Remove operation uses the attribute **path** for removing resources.

**Section2:** The following lists a few PATCH examples with the **Role** extension.
#### 1. Request: Add Role
```json
{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [
    {
      "op": "add",
      "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:Role:roles",
      "value": [
        {
          "roleName": "SHD_ROLE_ADMIN",
          "roleGroups": [
            "R&D-QA-Exp"
          ]
        }
      ]
    }
  ]
}
```

#### 2. Request: Replace Role
```json
{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [
    {
      "op": "replace",
      "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:Role:roles",
      "value": [
        {
          "roleName": "SHD_ROLE_ADMIN",
          "roleGroups": [
            "R&D-QA-Exp"
          ]
        }
      ]
    }
  ]
}
```

#### 3. Request: Remove a single Role
```json
{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [
    {
      "op": "remove",
      "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:Role:roles[roleName eq \"SHD_ROLE_ADMIN\"]"
    }
  ]
}
```
**NOTE:** Remove operation uses the attribute **path** for removing a specific identity.

#### 4. Request: Remove All Roles
```json
{
  "schemas": [
    "urn:ietf:params:scim:api:messages:2.0:PatchOp"
  ],
  "Operations": [
    {
      "op": "remove",
      "path": "urn:ietf:params:scim:schemas:extension:spend:2.0:Role:"
    }
  ]
}
```
**NOTE:** Remove operation uses the attribute **path** for removing resources.
