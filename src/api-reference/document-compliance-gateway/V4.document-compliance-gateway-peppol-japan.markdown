
# DCG-Peppol v4 API

DCG Invoice Accept API is private and allow only authorized Concur companies to validate and post Invoice document from Peppol Network into Concur via DRC(Document and Reporting Compliance).

* [Limitation](#limitations)
* [Process Flow](#process-flow)
* [Products and Editions](#products-editions)
* [Scope Usage](#scope-usage)
* [Authentication](#authentication)
* [Dependencies](#dependencies)
* [Endpoint Detail](#endpoint)

## Prior Versions

- No prior API version available

##  <a name="limitations"></a>Limitations
API access is available only to the authenticated companies with granted permission. Access to this documentation does not provide access to the API. The API is planned to be deployed to US2 & EU2 data centers.

## <a name="process-flow"></a>Process Flow

![](images/dcg_peppol_SequentialDiagram.png)

## <a name="products-editions"></a>Products and Editions

* Concur Invoice Professional Edition
* Concur Invoice Standard Edition

## <a name="scope-usage"></a>Scope Usage

Name|Description|Endpoint
---|---|---
`INVPMT`|Grants peppol invoice creation|POST

## <a name="authentication"></a>Authentication

Authentication is provided through an App for Business and the company JWT. This API requires the valid access token with required scopes. Before making requests to the API, please obtain an access token from the [Authentication API](https://developer.concur.com/api-reference/authentication/getting-started.html).

## <a name="dependencies"></a>Dependencies

SAP Concur Companies must purchase Concur Invoice in order to use this API. This API may require additional SAP Concur APIs for some use cases:

* [Peppol Invoice V4](https://wiki.concur.com/confluence/display/INV/Invoice+PEPPOL+-+Accept+End+Point+API)

## <a name="endpoint"></a>Peppol Invoice Endpoint (POST)

post peppol Invoice.

### Scopes

`invpmt`

### Request

#### URI

##### Template

```shell
POST https://{region}.api.concursolutions.com/document-compliance-gateway/v4/peppol/invoice
```
##### Parameters

Name|Type|Format|Description
---|---|---|---


#### Headers

* Content-Type
  * **Required**: Supports `application/json` 
* Authorization
  * Authentication would be provided through an App for Business and the company JWT. More details can be found [here](https://developer.concur.com/api-reference/authentication/getting-started.html) 
 
#### Notes

1. The company JWT is data center specific. The auth service (/token endpoint) that signs the JWT determines which DC the JWT will work in. It is recommended that the DRC should store the refresh token and use the geolocation response to make subsequent call to the DCG-API
2. To get a token or to refresh a token, use the curl command(s)specified [here](https://developer.concur.com/api-reference/authentication/getting-started.html). It is recommended to have a valid token and scope to make the post call to DCG API.
3. Once you have the token use the following curl command to POST invoice details
```sh
curl -X 'POST' 'https://integration.api.concursolutions.com/unstable-document-compliance-gateway/v4/peppol/invoice' -H 'Authorization: Bearer <JWT token>'
  -H 'Content-Type: application/json' \
  -d '<Payload Data>'
```

### Response

#### Error Codes

Code|Description
---|---
400|Validation errors in request body.
401|Unauthorized (invalid JWT or expired etc..,)
404|PEPPOL Company Not Found
500|Internal Server Error
503|Service Unavailable
502|Bad Gateway

### Example

#### Request

```shell
POST https://integration.api.concursolutions.com/unstable-document-compliance-gateway/v4/peppol/invoice
Accept: application/json
Authorization: Bearer <JWT Token>
```

#### Response
```shell
HTTP/1.1 200 OK
Content-Type: application/json
```

```json
{
  "invoiceNumber": "33445566",
  "message": "Standard Invoice is Valid for Concur Invoice",
  "participantId": "0188:45461212459",
  "status": "Success"
}
```
